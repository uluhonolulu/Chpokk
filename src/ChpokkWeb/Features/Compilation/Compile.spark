<content name="InlineScripts">
    <!--Compile-->
    <script type="text/javascript">
        $(function() {
            var compilerHub = $.connection.compilerHub;
            compilerHub.client.danger = function (message, wrap) { log(message, 'danger', wrap); };
            compilerHub.client.success = function (message, wrap) { log(message, 'success', wrap); };
            compilerHub.client.info = function (message, wrap) { log(message, 'info', wrap); };
            function connectThenDo(continuation) {
                $('#output').empty();
                $('#output').get(0).scrollIntoView(top);
                log("Please wait..");
                $.connection.hub.logging = true;
                $.connection.hub
                    .start()
                    .done(continuation)
                    .fail(function () {
                        alert("Failed to connect");
                });
               
            }
            $('#compileButton').click(function () {
                if (model.ProjectPath) {
                    connectThenDo(function () {
                        var editor = ace.edit("ace");
                        compilerHub.server.compile($.extend({}, model, { Content: editor.getValue() }));
                    });
                } else {
                    alert("Don't know what to compile. Please open a file first.");
                }
                //debugger;
             });
            $('#runButton').click(function() {
                if (model.ProjectPath) {
                    connectThenDo(function () {
                        var editor = ace.edit("ace");
                        compilerHub.server.compileAndRun($.extend({}, model, { Content: editor.getValue() }));
                    });			
                } else {
                    alert("Don't know what to run. Please open a file first.");
                }
            });
		    
            function log(message, category, wrapped) {
                if (wrapped === undefined) wrapped = true;
                if (wrapped) {
                    $('<div/>').text(message).addClass(category).appendTo($('#output'));
                } else {
                
                    $('<span/>').text(message).addClass(category).appendTo($('#output'));
                }
                
                //scroll to bottom
                var outputElement = $('#output').get(0);
                outputElement.scrollTop = outputElement.scrollHeight;

            }
        })
    </script>
</content>

